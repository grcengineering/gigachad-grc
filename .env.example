# ============================================================================
# GigaChad GRC - Environment Configuration Example
# ============================================================================
# IMPORTANT: Copy this file to .env before starting the application
#            NEVER commit your .env file to version control!
#
# To create your .env file:
#   cp .env.example .env
#
# For production deployments, see: env.example.production
# ============================================================================

NODE_ENV=development

# =============================================================================
# Security Secrets (REQUIRED - Generate unique values!)
# =============================================================================
# Generate these using the commands below. NEVER use the example values!
#
# Generate encryption key:    openssl rand -hex 32
# Generate JWT/session secret: openssl rand -base64 64
# Generate passwords:          openssl rand -base64 24
# =============================================================================

# 64-character hex key for encrypting sensitive data
# Generate: openssl rand -hex 32
# NOTE: Can be managed by external secrets provider (see SECRETS_PROVIDER)
ENCRYPTION_KEY=generate-a-64-char-hex-key-using-openssl-rand-hex-32

# Base64 secret for JWT token signing (64+ characters)
# Generate: openssl rand -base64 64
# NOTE: Can be managed by external secrets provider (see SECRETS_PROVIDER)
JWT_SECRET=generate-a-secure-jwt-secret-using-openssl-rand-base64-64

# Base64 secret for session encryption (64+ characters)
# Generate: openssl rand -base64 64
# NOTE: Can be managed by external secrets provider (see SECRETS_PROVIDER)
SESSION_SECRET=generate-a-secure-session-secret-using-openssl-rand-base64-64

# =============================================================================
# Database Configuration
# =============================================================================
POSTGRES_USER=grc
# Generate: openssl rand -base64 24
POSTGRES_PASSWORD=change-this-to-a-secure-password
POSTGRES_DB=gigachad_grc
DATABASE_URL=postgresql://grc:change-this-to-a-secure-password@localhost:5433/gigachad_grc

# =============================================================================
# Redis Configuration
# =============================================================================
# Generate: openssl rand -base64 24
REDIS_PASSWORD=change-this-to-a-secure-redis-password
REDIS_URL=redis://:change-this-to-a-secure-redis-password@localhost:6380

# =============================================================================
# MinIO (Object Storage)
# =============================================================================
MINIO_ROOT_USER=minioadmin
# Generate: openssl rand -base64 24
MINIO_ROOT_PASSWORD=change-this-to-a-secure-minio-password
MINIO_ENDPOINT=localhost
MINIO_PORT=9000

# =============================================================================
# Authentication (Keycloak)
# =============================================================================
KEYCLOAK_ADMIN=admin
# Change this for production!
KEYCLOAK_ADMIN_PASSWORD=change-this-admin-password
KEYCLOAK_REALM=grc
# Keycloak client secret for service-to-service auth (REQUIRED)
# Generate: openssl rand -base64 32
KEYCLOAK_ADMIN_CLIENT_SECRET=change-me-in-production
# Enable for development only - MUST be false in production!
USE_DEV_AUTH=false

# =============================================================================
# Phishing Simulation
# =============================================================================
# Secret for signing phishing tracking tokens (REQUIRED for phishing module)
# Generate: openssl rand -base64 32
PHISHING_TRACKING_SECRET=change-me-in-production

# =============================================================================
# CORS Configuration
# =============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:5174

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_ENABLED=true
# Window size in milliseconds (60000ms = 1 minute)
RATE_LIMIT_WINDOW_MS=60000
# Maximum requests per window per IP address
# This is a per-minute limit (based on RATE_LIMIT_WINDOW_MS above)
# 100 requests/minute = ~1.67 requests/second - suitable for most API usage
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# Security: Custom Integration Code Execution
# =============================================================================
# SECURITY WARNING: Custom code execution allows users to run arbitrary JavaScript
# code via new Function(). This is a significant security risk and is DISABLED by default.
# 
# Only enable if you:
# 1. Have strong network isolation for the controls service
# 2. Trust all users with access to custom integrations
# 3. Have proper monitoring and audit logging in place
#
# When disabled, users can still use "visual mode" for custom integrations.
ENABLE_CUSTOM_CODE_EXECUTION=false

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=info

# =============================================================================
# Frontend Configuration
# =============================================================================
VITE_API_URL=http://localhost:3001
VITE_ENABLE_DEV_AUTH=false
VITE_ENABLE_AI_MODULE=true
# Optional: CDN URL for training content (used for postMessage origin validation)
# VITE_TRAINING_CDN_URL=https://training.example.com

# =============================================================================
# Secrets Management (Optional)
# =============================================================================
# Provider for external secrets storage (integration credentials).
# Default: env (credentials encrypted locally with AES-256-GCM, no extra infrastructure)
# Built-in providers: env, infisical
# To add custom providers, see docs/secrets-management.md
SECRETS_PROVIDER=env
# SECRETS_CACHE_TTL=300

# --- Infisical (SECRETS_PROVIDER=infisical) ---
# Requires: docker compose --profile infisical up -d
# INFISICAL_SITE_URL=http://localhost:8443
# INFISICAL_CLIENT_ID=
# INFISICAL_CLIENT_SECRET=
# INFISICAL_PROJECT_ID=
# INFISICAL_ENVIRONMENT=dev
# INFISICAL_SECRET_PATH=/
# Bootstrap secrets (for self-hosted Infisical container only):
# INFISICAL_ENCRYPTION_KEY=
# INFISICAL_AUTH_SECRET=

# =============================================================================
# Optional: AI Integration
# =============================================================================
# OPENAI_API_KEY=sk-your-openai-api-key-here
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here

# =============================================================================
# Optional: Slack Integration
# =============================================================================
# SLACK_ENABLED=false
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/webhook/url
